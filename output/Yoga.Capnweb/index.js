// Generated by purs version 0.15.15
import * as $foreign from "./foreign.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Promise from "../Control.Promise/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Effect_Exception from "../Effect.Exception/index.js";
import * as FRP_Event from "../FRP.Event/index.js";
import * as Unsafe_Coerce from "../Unsafe.Coerce/index.js";
var liftEffect = /* #__PURE__ */ Effect_Class.liftEffect(Effect_Aff.monadEffectAff);
var bind = /* #__PURE__ */ Control_Bind.bind(Effect_Aff.bindAff);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var map = /* #__PURE__ */ Data_Functor.map(Effect_Aff.functorAff);
var getStats = $foreign.getStatsImpl;
var dup = $foreign.dupImpl;
var drain = function (conn) {
    return Control_Promise.toAff($foreign.drainImpl(conn));
};
var disposeStub = $foreign.disposeStubImpl;
var dispose = $foreign.disposeImpl;
var connectPair = $foreign.connectPairImpl;
var connect = $foreign.connectImpl;
var withSession = function (url) {
    return Effect_Aff.bracket(liftEffect(connect(url)))(function ($11) {
        return liftEffect(dispose($11));
    });
};
var callWithCallback = function (conn) {
    return function (method) {
        return function (callback) {
            return bind(Control_Promise.toAff($foreign.callWithCallbackImpl(conn, method, callback)))(function () {
                return pure(Data_Unit.unit);
            });
        };
    };
};
var subscribe = function (method) {
    return function (conn) {
        return function __do() {
            var v = FRP_Event.create();
            var cb = function ($12) {
                return v.push($12);
            };
            var fiber = Effect_Aff.launchAff(callWithCallback(conn)(method)(cb))();
            return {
                event: v.event,
                unsubscribe: Effect_Aff.launchAff_(Effect_Aff.killFiber(Effect_Exception.error("unsubscribed"))(fiber))
            };
        };
    };
};
var call2 = function (conn) {
    return function (method) {
        return function (a) {
            return function (b) {
                return map(Unsafe_Coerce.unsafeCoerce)(Control_Promise.toAff($foreign.call2Impl(conn, method, a, b)));
            };
        };
    };
};
var call1 = function (conn) {
    return function (method) {
        return function (a) {
            return map(Unsafe_Coerce.unsafeCoerce)(Control_Promise.toAff($foreign.call1Impl(conn, method, a)));
        };
    };
};
var call0 = function (conn) {
    return function (method) {
        return map(Unsafe_Coerce.unsafeCoerce)(Control_Promise.toAff($foreign.call0Impl(conn, method)));
    };
};
var call = function (conn) {
    return function (method) {
        return function (args) {
            return Control_Promise.toAff($foreign.callImpl(conn, method, args));
        };
    };
};
export {
    connect,
    connectPair,
    dispose,
    dup,
    disposeStub,
    withSession,
    call,
    call0,
    call1,
    call2,
    callWithCallback,
    subscribe,
    getStats,
    drain
};
//# sourceMappingURL=index.js.map
